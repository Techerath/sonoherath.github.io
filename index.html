<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voli con Herath - Aviazione Premium</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/ScrollTrigger.min.js"></script>
    <style>
        /* AGGIUNTA: Stili per il player musicale */
        .music-player {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 50px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(5px);
            border: 1px solid var(--gold);
            transition: all 0.3s ease;
        }
        
        .music-player:hover {
            background: rgba(0, 102, 204, 0.8);
            transform: scale(1.05);
        }
        
        .music-toggle {
            background: none;
            border: none;
            color: var(--gold);
            font-size: 18px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .music-icon {
            color: var(--gold);
            font-size: 20px;
        }
        
        #youtube-player {
            display: none; /* Nasconde il player reale */
        }
        
        /* Resto del tuo CSS esistente rimane invariato */
        :root {
            --accent: #0066cc;
            --dark: #0a2e6d;
            --light: #e6f2ff;
            --gold: #ffd700;
        }
        
        body {
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ed 100%);
            color: #333;
            overflow-x: hidden;
        }
        
        /* ... (tutto il resto del tuo CSS rimane identico) ... */
    </style>
</head>
<body>
    <!-- NAVIGAZIONE (rimane identica) -->
    <nav class="hero-nav">
        <!-- ... il tuo menu esistente ... -->
    </nav>
    
    <!-- HERO SECTION (rimane identica) -->
    <section class="hero-section" id="home-page">
        <!-- ... il tuo hero content esistente ... -->
    </section>
    
    <!-- PAGINA STORIA (rimane identica) -->
    <section class="story-page" id="story-page">
        <!-- ... la tua sezione about me esistente ... -->
    </section>

    <!-- AGGIUNTA: Player musicale YouTube -->
    <div class="music-player" id="musicPlayer">
        <button class="music-toggle" id="musicToggle">▶</button>
        <span class="music-icon">♫</span>
        <iframe 
            id="youtube-player"
            width="0" 
            height="0" 
            src="https://www.youtube.com/embed/6OhGIif_-R8?enablejsapi=1&autoplay=0&loop=1&playlist=6OhGIif_-R8" 
            frameborder="0" 
            allow="autoplay; encrypted-media" 
            allowfullscreen>
        </iframe>
    </div>

    <script>
        // 1. Carica l'API YouTube
        const tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        const firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // 2. Variabili globali
        let player;
        let isPlaying = false;

        // 3. Quando l'API è pronta
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('youtube-player', {
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        // 4. Quando il player è pronto
        function onPlayerReady(event) {
            event.target.setVolume(30); // Volume al 30%
            
            // Attiva al primo click (per policy autoplay)
            document.addEventListener('click', function initMusic() {
                player.playVideo();
                isPlaying = true;
                document.getElementById('musicToggle').textContent = "❚❚";
                document.removeEventListener('click', initMusic);
            }, { once: true });
        }

        // 5. Gestisci cambiamenti di stato
        function onPlayerStateChange(event) {
            const toggleBtn = document.getElementById('musicToggle');
            if (event.data === YT.PlayerState.PLAYING) {
                toggleBtn.textContent = "❚❚";
                isPlaying = true;
            } else {
                toggleBtn.textContent = "▶";
                isPlaying = false;
            }
        }

        // 6. Controllo manuale
        document.getElementById('musicToggle').addEventListener('click', function() {
            if (isPlaying) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        });

        /* RESTA DEL TUO SCRIPT ESISTENTE (GSAP, animazioni ecc.) RIMANE IDENTICO */
        // ... (tutte le tue funzioni GSAP esistenti) ...
    </script>
</body>
</html>